### 1. 应用架构与数据流
*   **框架与渲染**：纯 **AngularJS 指令** 搭配原生 **HTML5 Canvas** 进行绘制，无 Vue.js 依赖。
*   **数据订阅机制**：使用 **`StreamsManager`** 服务手动管理数据流订阅 (`add`/`remove`)，而非通过 Vue 混合属性自动订阅。
*   **数据更新驱动**：通过监听 AngularJS 的 **`$on('streamsUpdate', ...)`** 事件获取最新传感器数据，并触发整个画布的重绘。
*   **可用核心数据流**：`streamsList` 定义了唯一的数据源 `'sensors'`。

### 2. 核心数据处理
*   **数据源**：从 `streams.sensors` 对象中提取 `gx`, `gy`, `gx2`, `gy2` 以及 `gravity` 值。
*   **G力标准化**：所有传感器读数会除以 `-gravity` 进行标准化，转换为以重力加速度 g 为单位的向量（`gForces` 对象）。
    *   `gx`, `gy`：推测为实时/瞬时 G 力值（用于绘制橙色小点）。
    *   `gx2`, `gy2`：推测为经过平滑或二阶处理的 G 力值（用于绘制橙色大圆及历史轨迹）。
*   **极值记录与重置**：代码会追踪 `gx2`/`gy2` 在一定帧数（200帧）内的最大值与最小值 (`gxMax`, `gxMin` 等)，并定期清零。

### 3. 可视化绘制逻辑（关键元素）
1.  **坐标变换**：使用 `ctx.setTransform` 建立以画布中心为原点、缩放比例为 `size/200` 的坐标系，简化后续绘图计算。
2.  **背景层**：绘制同心圆网格 (`maxG` 控制最大显示G值) 和十字坐标轴。
3.  **历史轨迹**：将处理后的 `(px, py)` 坐标存入 `history` 数组，并以渐隐的白色线段连接绘制，形成“尾巴”效果。
4.  **瞬时值与平均值**：
    *   **小橙点**：由 `gForces.gx` 和 `gForces.gy` 决定，代表瞬时矢量。
    *   **大橙圈**：由 `gForces.gx2` 和 `gForces.gy2` 决定，代表平均/滤波后的矢量位置。两点之间用灰线连接。
5.  **极值指示器**：
    *   在坐标轴上用橙色短横线标记 `gxLargest` 和 `gyLargest`（当前记录周期内绝对值最大的 G 力）。
    *   从原点向极值位置绘制橙色实线。
6.  **文本标签**：在画布边缘显示当前平均 G 力值 (`gx2`, `gy2`) 及其对应极值的数字读数。

### 4. 关键可配置参数与扩展点
*   **绘图参数**：`maxG` (显示的最大G值)、`circleSize` (每G对应的像素半径)、`historySize` (轨迹长度) 直接控制视觉效果。
*   **样式变量**：所有 `ctx.strokeStyle`、`ctx.fillStyle`、`ctx.lineWidth`、`ctx.font` 均可修改以改变颜色、线宽和字体。
*   **数据扩展**：可修改 `streamsList` 订阅其他数据流，或在 `streamsUpdate` 事件中处理更多 `sensors` 下的数据（如 `gz`）。
*   **交互与布局**：监听了 `app:resized` 事件以实现响应式画布缩放，此逻辑可直接复用或修改。